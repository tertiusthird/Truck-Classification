# Truck-Classification

# Projeto por Tertius Sudário Gomes Ferraz

Desafio técnico para a vaga de ciêntista de dados Junior

O objetivo do projeto é identificar caminhões que possuem o sistema de ar defeituoso antes deles quebrarem no meio de uma estrada ou em serviço, causando assim vários problemas. 

Carregando duas base de dados, uma com dados de todos os anos anteriores, e a segunda com dados do ano de 2022. Como queremos avaliar o desempenho e o impacto financeiro caso o modelo estivesse em funcionamento no ano de 2022, Então devemos treinar nossos modelos com os dados dos anos anteriores e validar nesses dados. Apenas após isso que poderemos análisar o impacto no ano de 2022. Para isso, primeiro removemos do nosso dataframe dos anos anteriores as colunas (features) que possuiam mais de 10% de seus valores nulos, para evitar que tivesse baixa variância quando for realizado o tratamento dos valores nulos. Para ter consistência, como removemos essas colunas do primeiro dataset, também removemos as mesmas colunas do dataset de 2022. dividimos o dataset dos anos anteriores em 80% treino e 20% teste e apenas após esse passo podemos realizar o preenchimento de valores nulos para a média das colunas, assim evitando data leakage, Em seguida é realizado a padronização dos dados, para nenhuma coluna ser enviesar os modelos, devido a discrepância entre os valores máximos e mínimos entre os dados. Embora não seja necessário padronizar os dados para o modelo XGBOOST e o random forest, ainda há uma certa vantagem, pois o modelo pode convergir mais rápido. Também garante uma base de comparação consistente ao fazer comparações com outros modelos que precisam, neste nosso caso a regressão logística, mas também se quisermos expandir para comparar com outros modelos (SVM e modelos com base em redes neurais...)

Foi testado 3 algoritmos de aprendizagem de máquina, sendo eles regressão logística, random forest e xgboost. Todos passaram por um busca em grade com valização cruzada 10 folds. Os resultados da validação cruzadas passam pelo teste estatístico de friedman para verficiar se há diferença estatística significativa entre as métricas avaliadas, e sendo o caso, realizar o pós teste de Nemenyi. Como temos classes desbalanceadas, alguns modelos podem ter dificuldades de prever a classe minoritária, que foi o caso da regressão logística. Como o Random Forest e o XGBoost tiveram bons resultados na métrica Recall (Sensibilidade do modelo) e queremos otimizar os Verdadeiros positivos, está é a váriavel que devemos otimizar. Utilizei de feature_importance do random forest para identificar as features mais importantes da nossa base de dados. Também defini uma métrica de negócios, que foi a matriz de custos, para calcular os custos totais das predições dos dois melhores modelos. Também tentei aplicar um threshold na predição do melhor modelo de XGBOOST para maximização do recall, mas o melhor threshold foi muito próximo do threshold default (0.494949 contra 0.5), não trazendo melhoras significativas para o nosso modelo.

Conclusão:

No modelo de Random Forest para o ano de 2022, temos **Recall: 91,47% (343 VERDADEIROS POSITIVOS, 32 FALSOS NEGATIVOS) e 298 FALSOS POSITIVOS**.
No modelo XGBOOST para o ano de 2022, temos **Recall: 89,60% (336 VERDADEIROS POSITIVOS, 39 FALSOS NEGATIVOS) e 144 FALSOS POSITIVOS**.

Embora tenhamos mais falsos positivos no modelo de Random Forest, isso só representa um aumento de 2980 dólares, mas detecta sistemas de ar defeituosos ligeiramente melhor.

Este problema de classificação é muito importante para a empresa, pois podemos determinar quais características têm o maior impacto nos sistemas de ar defeituosos. Com isso, a empresa pode tomar medidas para monitorá-los melhor. Além disso, detectar quando o sistema de ar está defeituoso é crucial para evitar inconvenientes e quebras durante o transporte. Sabemos que a empresa gastou $375 mil durante 2022 com caminhões que quebraram o sistema de ar, e demonstramos com 2 modelos que a empresa deveria ter gasto cerca de 27-30 mil dólares, economizando cerca de 345 mil dólares que poderiam ser investidos em outros setores. A empresa também deve analisar o custo para investir nesse tipo de sistema para outros problemas que possam ter.
